(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11450,        301]
NotebookOptionsPosition[     10706,        280]
NotebookOutlinePosition[     11083,        297]
CellTagsIndexPosition[     11040,        294]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "p", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"Pi", "/", "2"}], ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", "\:53c2\:6570\:8bbe\:7f6e", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "=", "10"}], ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]i", "=", "h"}], ";", 
      RowBox[{"(*", "\:521d\:59cb\:89d2\:5ea6", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xc", "=", 
       RowBox[{
        FractionBox["l", "2"], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xcp", "=", 
       RowBox[{"D", "[", 
        RowBox[{"xc", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "m", "*", 
         SuperscriptBox["xcp", "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], "*", 
         FractionBox["1", "12"], "m", "*", 
         SuperscriptBox["l", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["xcp", 
            RowBox[{
             FractionBox["l", "2"], 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]], ")"}], "2"]}], 
        "-", 
        RowBox[{"m", "*", "g", "*", "xc"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "\:751f\:6210\:6f14\:5316\:65b9\:7a0b", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"eq1", "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", 
          RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], "==", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"L", ",", 
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]v", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "\:521d\:59cb\:89d2\:901f\:5ea6", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"eq1", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "\[Theta]i"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", 
            "\[Theta]v"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"{", "\[Theta]", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\:8d4b\:503c", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Theta]r", "=", 
       RowBox[{"\[Theta]", "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "\:753b\:56fe", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"\[Theta]r", "[", "t", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1", ",", "0.001"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", 
               RowBox[{"{", 
                RowBox[{"h", ",", 
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}]}], ",", 
              RowBox[{"j", "++"}], ",", 
              RowBox[{
               RowBox[{"Break", "[", "]"}], ";"}]}], "}"}], ","}], "]"}], 
          ";"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "0", ",", 
      RowBox[{"Pi", "/", "2"}], ",", "0.01"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.871850782237912*^9, 3.8718509274421177`*^9}, {
  3.871850971120901*^9, 3.8718510297408433`*^9}, {3.8718511952307854`*^9, 
  3.871851210726113*^9}, {3.871851241210534*^9, 3.8718513239350634`*^9}, {
  3.8718513601833324`*^9, 3.8718513792097263`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"38b0d9a9-1080-4b55-9457-c07438b9953d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"p", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RawBoxes", "[", 
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<\\\\\>\"", ",", "\"\<theta\>\""}], "}"}], "]"}], "]"}], 
      ",", 
      RowBox[{"HoldForm", "[", "t", "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "None"}], ",", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"GrayLevel", "[", "0", "]"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8718513874453535`*^9, 3.8718514011685734`*^9}, {
  3.871851466218231*^9, 3.8718515158667707`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"a1dc94d5-8f3a-40b1-a6de-7796a83ccb60"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxdlnuIVGUYxpdFJETMxMosTKXMEBEJCZN6Cume5QVEZJFl0RIzNTEzC0NK
IkTsoliZmrdqQ5ZtWWqTdd37/TKXM3PmsnPb2dmZvc99JrrQeb/zeP7owDLs
me983/s8v+d9zyyp2L95V2lJSckF408+71x/V6YcGyo24sP5VS9Gjn6Kk3vj
f1WmrvD/M3iqtvNww6VfULfoxPimuosw11fz+2tcX4PvvpWrEj2Xn/8t808t
11dhln71wNOzfsfEJrnzK67I11odn6/l/jetdY+XnW7OLa/nfn/ggRlb56ys
uWXdv+vGQ9t3rrvN/Rvwc/urT37+XCOuGU/rVxvxmvFfeayR5zUh+ZMsaMIT
6mrBmQWyYTPPb0X0+vnWxdXNaMktN05ow2f3efsLW1pYTwfUh96CzerATus5
s74u6m1F5Kh80Y0HVwUemXm8jfX24u36Q18vmNGOd6W8A31460252ll/P8SN
I6PtMGnYMPP42fUn93ZQjw2lK6SiDrykDrBbdZj67Hi9Yu62tbWdkNPKTjtw
cVoEd1Gv06rT1OHE2LLVhoXd1KFhxLbU/+exbjws5SxyWTpMP1wQNWfX97Bu
N8Sd6PUe+qPDdWTU2LEXstv8Kh122W5PL+v0oK9XXcjLdjkPugzaC1f1sS4v
2hZXH9z9ZR+eURv60NQthvaxDh9uiX1b+6HKO+HHrnWhN06d66e/gyiPiYB+
njMIdbtsgH4HIOYcbhjAvarAoOWz6X8Q/2oiwMbnQqzbxnVhbDx1bt+8T2y8
H6bfNvIJM8826gvjh4USADt5RZAVvMvs1BtB2uieudvs5BfBCyoAduof4jo7
eQ7hG+P0xm47/RiyuJt8o3h2zY6bL8920J8o93GQdxRfTX6ENTsc9GsYyq5j
DvIfZv4d9G8Yqn1sDuYhxv520M8Y1NdLncxHjPlw0t8RrFYN6mReRliXk36P
wBBjAHYyP3Erl6b/cai4F5zMUxwf75EG0sgjAafYt1YjjwQeUwdq5JHAo6qB
NPJI4AOJ5w2NPEapU6PPo1gi8ZvU6Oso3pO4zXHRxzHm1YUvFI8xdMi4Kb/T
J2Psdxd5jGO/4Lrsou5xq49MneO4XzWQizwmOB/c5DGB25ckQG7WOcH8u8lj
EveoQLvJYxI7VT+4ec4kfXaTxxRmqwHiJo8p9oub66Yg6SldoZPHNGouyADR
yWOa80gnj2lsVwfq5JFkf+nUk4QazyGdfJJc56G+JPvNQ17J/82JJH6UOB70
kF+S6zzUn0JxiyTWQ54pa66YfqTwiimYfFNc56U/KXwv2+/2knfKmkOmX2n2
m5f801znpX9pzk8f+zONhHTHBh/9THOe+piPNPvLR38z1lwz85KB0Ns3z0+/
M+wnP/OTseae6X+G/eNnnjJQeOJ++py15qL5meU8HqTPWQzI+D4/SB5ZvC/x
DgzS5yzzHiCPrDVHTZ+zfB8HyCPH/Abpc455DfK5HO5eKYkK0ucc8xckjxzz
FqLPOeoMkUee75cweeT5vg+TR546wuSR53wOk0femsum73m+HyPkUWD/Rsij
gHfUuIuQR4G/F4bIoWDNZbPOAvUMkUcB4nb9oSh5FDnPouRRpP/D5FHk+yBG
HUXqHCGPIudpnDyK/L2RoK4i8zCO/wBDTfo5
       "]]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[
      1.6]}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[
      1.6]}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    RowBox[{"\\", "theta"}], 
    FormBox[
     TagBox["t", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{421.9999999999945, Automatic},
  LabelStyle->{
    GrayLevel[0]},
  Method->{
   "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.56}, {0, 0.866}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.871851387815778*^9, 3.871851401532078*^9}, {
  3.871851484963752*^9, 3.8718515164190006`*^9}},
 CellLabel->
  "Out[207]=",ExpressionUUID->"b3d17642-08a7-49af-8599-0691ddfb7d4f"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.8718514888163595`*^9},
 NumberMarks->False,
 CellLabel->
  "In[204]:=",ExpressionUUID->"232d3a82-9088-41dd-8d8c-a6355839c737"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.871850941622959*^9, 3.87185094772964*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"ce5a46a3-5c0b-4fb6-af9f-63ff61329e65"]
},
WindowSize->{1920, 977},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
Magnification->1.5,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (2019\:5e745\:670818\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5301, 136, 1208, "Input",ExpressionUUID->"38b0d9a9-1080-4b55-9457-c07438b9953d"],
Cell[CellGroupData[{
Cell[5884, 160, 750, 19, 66, "Input",ExpressionUUID->"a1dc94d5-8f3a-40b1-a6de-7796a83ccb60"],
Cell[6637, 181, 3699, 85, 419, "Output",ExpressionUUID->"b3d17642-08a7-49af-8599-0691ddfb7d4f"]
}, Open  ]],
Cell[10351, 269, 174, 4, 43, "Input",ExpressionUUID->"232d3a82-9088-41dd-8d8c-a6355839c737"],
Cell[10528, 275, 174, 3, 43, "Input",ExpressionUUID->"ce5a46a3-5c0b-4fb6-af9f-63ff61329e65"]
}
]
*)

(* End of internal cache information *)

